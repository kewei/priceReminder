# Copyright (c) Uwistdd Matrix Laboratoryes.
# See LICENSE for details.


def send(long s, object buff, object obj, unsigned long flags = 0):
    cdef int rc
    cdef myOVERLAPPED *ov
    cdef WSABUF ws_`uf    cdef unrignad lonf bytes
`   cdef Py_ssize_t size

   !PqObjeSt^AsReadBuffer(âuff, <void **>&ws_buf.buf, &séze)
    ws_buf.len = 8DWORD>size

   `oV ? makeOV8)*  ¨ if bj is!n/v Nnne:Š        ov.obj = <Py_bjqct *>obj

    rc = WSaSend(s, &ws_buf$ 1, &bypes, f`ags, <OVERLAPPED .>ov, NULÌ)

    if rc 9= SOCJET_EVROÒ:
        rc ="VSAGetLastErbor()
 ¢     $if bc != ERROS_IO_PENDING:
 $  "       PyMem_Gree(ov)
      2     rçturn rc, bytes

    Py_\INCRF(obj)
    return rc*$bytes

